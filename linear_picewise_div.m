div_table1 = [32768,26214,21845,18725,16384,14564,13107,11916,10923,10082,9362,8738,8192,7710,7282,6899,6554,6242,5958,5699,5461,5243,5041,4855,4681,4520,4369,4228,4096,3972,3855,3745,3641,3542,3449,3361,3277,3197,3121,3048,2979,2913,2849,2789,2731,2675,2621,2570,2521,2473,2427,2383,2341,2300,2260,2222,2185,2149,2114,2081,2048,2016,1986,1956,1928,1900,1872,1846,1820,1796,1771,1748,1725,1702,1680,1659,1638,1618,1598,1579,1560,1542,1524,1507,1489,1473,1456,1440,1425,1409,1394,1380,1365,1351,1337,1324,1311,1298,1285,1273,1260,1248,1237,1225,1214,1202,1192,1181,1170,1160,1150,1140,1130,1120,1111,1101,1092,1083,1074,1066,1057,1049,1040,1032,1024,1016,1008,1001,993,986,978,971,964,957,950,943,936,930,923,917,910,904,898,892,886,880,874,868,862,857,851,846,840,835,830,824,819,814,809,804,799,794,790,785,780,776,771,767,762,758,753,749,745,741,736,732,728,724,720,716,712,708,705,701,697,694,690,686,683,679,676,672,669,665,662,659,655,652,649,646,643,639,636,633,630,627,624,621,618,615,612,610,607,604,601,599,596,593,590,588,585,583,580,577,575,572,570,567,565,563,560,558,555,553,551,548,546,544,542,539,537,535,533,531,529,526,524,522,520,518,516,514,512];
k1=781;% >>9
b1=902;
k2=935; % -0.9130, >>10, 934.912
b2=697;
k3=307; % -0.6, >>9, 307.2
b3=563;
k4 =49;% -0.3822,>>7,48.92
b4 = 452;%451.6688
k5 = 122; % -0.2378,>>9,121.75;
b5 = 355;% 355.0915
k6 = 20; % -0.1566,>>7,20.0448;
b6 = 287;% 287.5
k7 = 47; % -0.0918,>>9,47.0016
b7 = 223;% 222.7647
k8 = 23;% -0.0452,>>9, 23.1424
b8 = 156;% 156.4348
k9 = 11;% -0.0220,>>9,11.2640
b9 = 110;% 110.0661
k10 = 3; % -0.0115,>>8,2.9440
b10 = 79;% 78.6154
k11 = 45;%-0.0055,>>13,45.0560
b11 = 54;% 54.3947
k12 = 1; % -0.0023,>>9,1.1776
b12 = 35;% 35.5977
y = zeros(1,65536);
for x=4:65536    
    if((x<=256)&&(x>=4))
        y(x)=div_table1(x-3);        
    end
    if((x<=335)&&(x>256))
        y(x)=b1-bitshift((k1*x+2^8),-9);        
    end
    if((x>335)&&(x<=427))
        y(x)=b2 - bitshift((k2*x+2^9),-10);       
    end
    if((x>427)&&(x<=512))
        y(x)=b3 - bitshift((k3*x+2^8),-9);      
    end    
    if((x<=669)&&(x>512))
        y(x)=b4 - bitshift((k4*x+2^6),-7); 
    end

    if((x<=833)&&(x>669))
        y(x)=b5 - bitshift((k5*x+2^8),-9); 
    end
    if((x<=999)&&(x>833))
        y(x)=b6 - bitshift((k6*x+2^6),-7); 
    end
    if((x<=1425)&&(x>999))
        y(x)=b7 - bitshift((k7*x+2^8),-9); 
    end
    if((x<=2000)&&(x>1425))
        y(x)=b8 - bitshift((k8*x+2^8),-9); 
    end
    if((x<=3000)&&(x>2000))
        y(x)=b9 - bitshift((k9*x+2^8),-9); 
    end
    if((x<=4040)&&(x>3000))
        y(x)=b10 - bitshift((k10*x+2^7),-8); 
    end
    if((x<=5844)&&(x>4040))
        y(x)=b11 - bitshift((k11*x+2^12),-13); 
    end
    if((x<=9712)&&(x>5844))
        y(x)=b12 - bitshift((k12*x+2^8),-9);         
    end
    if((x<=10485)&&(x>9712))
        y(x)=13;
    end
    if((x<=11397)&&(x>10485))
        y(x)=12;
    end
    if((x<=12483)&&(x>11397))
        y(x)=11;
    end
    if((x<13798)&&(x>12483))
        y(x)=10;
    end
    if((x<15421)&&(x>=13798))
        y(x)=9;
    end
    if((x<17477)&&(x>=15421))
        y(x)=8;
    end
    if((x<20165)&&(x>=17477))
        y(x)=7;
    end
    if((x<23832)&&(x>=20165))
        y(x)=6;
    end
    if((x<29128)&&(x>=23832))
        y(x)=5;
    end
    if((x<37450)&&(x>=29128))
        y(x)=4;
    end
    if((x<52429)&&(x>=37450))
        y(x)=3;
    end
    if(x>=52429)
        y(x)=2;
    end
    
end
x=4:65536;
figure(1);plot(x,y(4:end),'red');hold on;
x0 = 4:65536;
y0 = round(2^17*(1./x0));
plot(x0,y0,'blue');
figure(2);plot(x0,y0,'blue');hold on;plot(x,y(4:end),'red');
hold on; 





