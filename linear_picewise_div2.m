div_table1 = [131072,104858,87381,74898,65536,58254,52429,47663,43691,40330,37449,34953,32768,30840,29127,27594,26214,24966,23831,22795,21845,20972,20165,19418,18725,18079,17476,16913,16384,15888,15420,14980,14564,14170,13797,13443,13107,12788,12483,12193,11916,11651,11398,11155,10923,10700,10486,10280,10082,9892,9709,9533,9362,9198,9039,8886,8738,8595,8456,8322,8192,8066,7944,7825,7710,7598,7490,7384,7282,7182,7085,6991,6899,6809,6722,6637,6554,6473,6394,6317,6242,6168,6096,6026,5958,5891,5825,5761,5699,5638,5578,5519,5461,5405,5350,5296,5243,5191,5140,5090,5041,4993,4946,4900,4855,4810,4766,4723,4681,4640,4599,4559,4520,4481,4443,4406,4369,4333,4297,4263,4228,4194,4161,4128,4096,4064,4033,4002,3972,3942,3913,3884,3855,3827,3799,3772,3745,3718,3692,3666,3641,3616,3591,3567,3542,3519,3495,3472,3449,3427,3404,3383,3361,3339,3318,3297,3277,3256,3236,3216,3197,3178,3158,3139,3121,3102,3084,3066,3048,3031,3013,2996,2979,2962,2945,2929,2913,2897,2881,2865,2849,2834,2819,2804,2789,2774,2759,2745,2731,2717,2703,2689,2675,2661,2648,2635,2621,2608,2595,2583,2570,2558,2545,2533,2521,2509,2497,2485,2473,2461,2450,2439,2427,2416,2405,2394,2383,2372,2362,2351,2341,2330,2320,2310,2300,2289,2280,2270,2260,2250,2241,2231,2222,2212,2203,2194,2185,2175,2166,2158,2149,2140,2131,2123,2114,2106,2097,2089,2081,2072,2064,2056,2048];
k1= 1565;% -6.1139,>>8, 1.5652e+03
b1=3613; % 3.6132e+03
k2=935; % -0.9130, >>10, 934.912
b2=697;
k3=307; % -0.6, >>9, 307.2
b3=563;
k4 =49;% -0.3822,>>7,48.92
b4 = 452;%451.6688
k5 = 122; % -0.2378,>>9,121.75;
b5 = 355;% 355.0915
k6 = 20; % -0.1566,>>7,20.0448;
b6 = 287;% 287.5
k7 = 47; % -0.0918,>>9,47.0016
b7 = 223;% 222.7647
k8 = 23;% -0.0452,>>9, 23.1424
b8 = 156;% 156.4348
k9 = 11;% -0.0220,>>9,11.2640
b9 = 110;% 110.0661
k10 = 3; % -0.0115,>>8,2.9440
b10 = 79;% 78.6154
k11 = 45;%-0.0055,>>13,45.0560
b11 = 54;% 54.3947
k12 = 1; % -0.0023,>>9,1.1776
b12 = 35;% 35.5977
y = zeros(1,65536);
for x=4:65536    
    if((x<=256)&&(x>=4))
        y(x)=div_table1(x-3);        
    end
    if((x<=335)&&(x>256))
        y(x)=b1-bitshift((k1*x+2^8),-9);        
    end
    if((x>335)&&(x<=427))
        y(x)=b2 - bitshift((k2*x+2^9),-10);       
    end
    if((x>427)&&(x<=512))
        y(x)=b3 - bitshift((k3*x+2^8),-9);      
    end    
    if((x<=669)&&(x>512))
        y(x)=b4 - bitshift((k4*x+2^6),-7); 
    end

    if((x<=833)&&(x>669))
        y(x)=b5 - bitshift((k5*x+2^8),-9); 
    end
    if((x<=999)&&(x>833))
        y(x)=b6 - bitshift((k6*x+2^6),-7); 
    end
    if((x<=1425)&&(x>999))
        y(x)=b7 - bitshift((k7*x+2^8),-9); 
    end
    if((x<=2000)&&(x>1425))
        y(x)=b8 - bitshift((k8*x+2^8),-9); 
    end
    if((x<=3000)&&(x>2000))
        y(x)=b9 - bitshift((k9*x+2^8),-9); 
    end
    if((x<=4040)&&(x>3000))
        y(x)=b10 - bitshift((k10*x+2^7),-8); 
    end
    if((x<=5844)&&(x>4040))
        y(x)=b11 - bitshift((k11*x+2^12),-13); 
    end
    if((x<=9712)&&(x>5844))
        y(x)=b12 - bitshift((k12*x+2^8),-9);         
    end
    if((x<=10485)&&(x>9712))
        y(x)=13;
    end
    if((x<=11397)&&(x>10485))
        y(x)=12;
    end
    if((x<=12483)&&(x>11397))
        y(x)=11;
    end
    if((x<13798)&&(x>12483))
        y(x)=10;
    end
    if((x<15421)&&(x>=13798))
        y(x)=9;
    end
    if((x<17477)&&(x>=15421))
        y(x)=8;
    end
    if((x<20165)&&(x>=17477))
        y(x)=7;
    end
    if((x<23832)&&(x>=20165))
        y(x)=6;
    end
    if((x<29128)&&(x>=23832))
        y(x)=5;
    end
    if((x<37450)&&(x>=29128))
        y(x)=4;
    end
    if((x<52429)&&(x>=37450))
        y(x)=3;
    end
    if(x>=52429)
        y(x)=2;
    end
    
end
x=4:65536;
figure(1);plot(x,y(4:end),'red');hold on;
x0 = 4:65536;
y0 = round(4*2^17*(1./x0));
plot(x0,y0,'blue');
figure(2);plot(x0,y0,'blue');hold on;plot(x,y(4:end),'red');
hold on; 





